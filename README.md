See code in action at timscode.com